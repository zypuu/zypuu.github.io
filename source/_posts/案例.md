---
title: 案例
date: 2090-01-01 00:00:00
tags: 架构
categories: 系统架构设计
comments: true
description: 系统架构基础一些问题，笔记
---

#### 鸿蒙

![1](1.jpg)

4个特性：

1、分布式架构首次用于终端OS，实现跨终端无缝协同

2、确定时延引擎和高端IPc技术实现系统天生流畅

3、基于微内核架构重塑终端可信安全

4、统一IDE一次开发，多端部署，实现跨终端生态共享

分布式架构体现4个方面：

分布式软总线，分布式数据管理，分布式设备虚拟化，分布式任务调度

分布式软总线，终端设备的统一基座，多个设备互联提供统一的分布式通信能力

分布式设备虚拟化，多个设备资源融合，设备管理，数据处理，多种设备共同形成虚拟化终端，为用户匹配能力适合的执行硬件

分布式数据管理，实现程序数据和用户数据的分布式管理，用户数据不再与单一设备绑定，业务逻辑与数据存储分离，实现跨设备数据共享

分布式任务调度，实现分布式任务管理，发现，注册，调用，同步机制，支持跨设备远程调用，远程连接，迁移等操作，选择合适的设备运行分布式任务



#### 质量属性和架构风格

![1](2.jpg)

交互方式，数据结构，控制结构，扩展方法

管道过滤：

交互方式：管道过滤是顺序交互，前一个的输出作为后一个的输入

数据结构：管道过滤是基于数据流结构的，构件之间传递是常规数据结构

控制结构：数据流顺序传递

扩展方法：增加过滤器，通过接口适配扩展

数据仓库，共享：

交互方式：星型交互，通过共享数据库进行交互

数据结构：基于数据库的数据结构，多维结构存储

控制结构：面向应用，由业务驱动

扩展方法：通过模型适配，数据库增加数据

面向对象：

交互方式：对象之间消息传递，调用进行交互

数据结构：对象数据结构，面向对象，封装了属性和方法

控制结构：对象的继承，封装，多台态，对象间的调用

扩展方法：通过创建新的对象类，继承，扩展，重载来扩展系统功能

解释器：

交互方式：接收用户的命令，解释命令，进行用户操作，返回结果

数据结构：语法分析器，执行器来执行用户命令

控制结构：由解释器的语法，执行器的业务逻辑决定，自定义规则

扩展方法：增加新的命令或扩展，新的规则来扩展功能



#### 云原生架构

![1](3.jpg)

云原生架构原则：

服务化架构原则：拆分微服务，小服务架构，分别迭代

弹性原则：系统规模随着业务量的增长，自动伸缩

可观测原则：通过日志链路追踪等手段

韧性原则：所依赖的软硬件出现异常时，系统的抵御能力

自动化原则：交付自动化

架构持续演进原则

云原生架构模式：

服务化架构模式：微服务和小服务模式，代码模块关系和部署关系进行分离，每个服务可以独立部署和扩展，单独扩缩容，满足不同的需求

Mesh架构模式：中间件框架从业务中分离，交给Mesh接管，业务进程中只保留很薄的client

serverLess模式：无服务模式，无需关心部署，用户不需要关心部署环境，操作系统，网络配置，CPU性能等，运行委托给云

存储计算分离模式：存储，计算分离的架构模式，各类数据通过云存储与计算分离

分布式架构模式：用来解决微服务架构模式中访问多个数据源所带来的分布式事务问题

云原生技术：

容器技术：作为标准软件单元，将应用及所有依赖项打包，使应用不再受环境限制，在不同计算环境间快速运行和迁移，实现了应用隔离和快速部署，使得应用部署更加灵活高效，易于维护和管理。

提高了资源的利用率，降低了部署成本和时间，增强了应用的可移植性和一致性。

微服务技术：将复杂的应用拆分多个微服务，每个微服务可以独立开发，测试，部署和扩展，在云原生架构，可以基于容器进行部署和管理实现更细粒度的资源分配和弹性扩展

提升了系统的灵活性和可扩展性，能够快速响应业务需求的变化，各个微服务可以独立更新和维护，降低了系统的复杂度和风险



无服务技术：屏蔽了服务器运维的各种复杂度，让开发人员有有更多精力用于业务逻辑设计和实现。

全托管的计算服务：用户无关心底层服务的运维和管理。降低开发人员的运维负担，提高开发效率

自动弹性伸缩：根据系统的负载自动弹性伸缩资源

按量计费：按实际使用的资源进行计费

通用性：可以支持云上所有重要类型的应用，通用性较高



#### 架构评估

基于场景的架构评估方法SAAM：

SAAM分析评估体系结构的过程包括五个步骤，即场景开发、体系结构描述、单个场景评估、场景交互和总体评估

架构权衡分析法ATAM：

4个活动领域：场景和需求收集，体系结构和场景实现、属性模型架构分析和评审、折中

效应树：树根，质量属性，质量属性分类，质量属性使用场景

4个阶段：

1、描述和介绍阶段：收集相关架构材料，定义评估架构目标，明确要优化的质量属性，介绍ATAM方法的步骤和原则

2、调查和分析阶段：确定架构方法，分析架构方法对质量属性的影响，识别潜在问题，和权衡决策，产出质量效应树

3、测试阶段：验证架构是否满足质量属性需求。模拟质量属性场景，性能测试，压力测试，安全测试。并记录测试结果，评估团队对质量属性进行分级，架构方法进行选择，评审，投票选择最合适的架构方法

4、报告阶段：团队生成ATAM的评估报告，包括评估发现，性能数据，可能的改进建议以及权衡决策，为决策者提供决策依据。

评估原则：

多样化参与者，明确质量属性，场景驱动，权衡优先级，风险管理，协作和交流

#### SOA和微服务

##### 企业应用集成

界面集成，数据集成，控制集成，过程集成（业务流程集成）

![1](4.jpg)

##### 微服务

特点：复杂服务解耦，独立部署扩展，松耦合，技术选型灵活，轻量级通信机制，容错性，纵向业务划分

挑战：复杂性，分区数据库体系，不同服务不同数据库，测试复杂性，分布式复杂性

设计模式：

异步消息微服务：消息队列

链式微服务：调用链

数据共享微服务：共享数据库

聚合器微服务：多功能多服务

##### SOA

特点：服务中心、松耦合、服务复用可重用性、标准化接口SOAP，服务治理，可维护性，灵活性，水平多层

协议：UDDI服务注册发现，WSDL服务的接口和操作，SOAP跨平台标准的通信协议

![1](5.jpg)

设计模式：注册表模式，企业总线ESB模式，微服务模式

ESB核心功能：

产生一个服务请求，通过服务总线，按照ESB的要求标准化，通过总线进行组件服务查找，转发消息到目标服务，目标服务处理后将结果，返回给服务请求者

提供位置透明的消息服务和寻址服务

提供服务注册和管理功能

提供日志监控

提供多种数据格式相互转换

提供多种消息传递范型

#### 软件工程

##### 结构化分析方法

自顶向下，逐步分解，面向数据

以功能角度，数据流图

以行为角度，状态转换

以数据角度，ER图，实体联系图

数据字典，在DFD基础上，命名元素加以定义，解释

数据平衡：黑洞，灰洞，奇迹

##### 面向对象分析法

认定对象，组织对象，描述对象间的相互作用，确定对象的操作，定义对象的内部信息

对象属性，方法

实体类，接口类（边界类），控制类

设计原则：

单一职责原则：类只做一件事

开放封闭原则：可以扩展，不可以修改

里氏替换原则：子类可以替换父类

依赖倒置原则：抽象依赖于细节，高层模块，低层模块通过抽象交互

接口分离原则：接口只包含需要的方法，避免冗余和不必要的复杂性

##### UML图

![1](6.jpg)

#### 数据库相关

反规范技术，分布式数据库带来的数据不一致性：更新异常，插入异常

解决方案：

1、定时器数据同步

2、触发器控制

3、应用程序控制

4、事务管理

分布式数据库特点：可扩展性，高可用，可靠性，灵活性，分布式处理，性能优化

主从读写分离特点：数据冗余和读取负载均衡，备份与恢复，高可用性，提高并发性能，降低延迟，水平扩展

同步复制，半同步复制，异步复制，事务级别一致性读取，多版本控制保证读取一致性