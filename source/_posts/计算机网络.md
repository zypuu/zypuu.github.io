---
title: 计算机网络
date: 2024-01-20 16:20:00
tags: 架构
categories: 系统架构设计
comments: true
description: 计算机网络相关，osi七层模型，ip地址等
---

计算机网络的功能： 数据通信 、资源共享 、管理集中化 、实现分布式处理 、负 载均衡。
网络性能指标： 速率 、带宽(频带宽度或传送线路速率)、吞吐量 、时延 、往返时间 、利用率。
网络非性能指标： 费用 、质量 、标准化 、可靠性 、可扩展性 、可升级性 、易管理性和可维 护性。

## 拓扑分类

### 总线型拓扑
特点:采用总线的形式将所有计算机相连,信息只能在一条线路上传输。
- 优点:成本低,实现简单。
- 缺点:带宽低,延迟高,任何节点发生故障整条总线瘫痪。
- 举例:一个简单的以太网线路就是总线型拓扑的一个例子 。所有计算机通过网线连接到交
换机的各个端口上,数据只能在这条总线上传输
![1](1.jpg)
### 星型拓扑
- 特点:通过一个中心交换机将计算机互联,形成星型网络。
- 优点:容易扩展,集中管理。
- 缺点: 中央交换机单点故障会瘫痪全网。
- 举例:一个小型办公室的网络就可以采用星型拓扑 。计算机通过网线连接到中心的交换机
上,形成星型结构
![1](2.jpg)
### 环型拓扑
- 特点:计算机按环形连接,信息只能前进或后退进行传输。
- 优点:故障启闭容易诊断。
- 缺点:数据传输效率低,扩展性差
![1](3.jpg)
### 树型拓扑
- 特点:采用分级交换机进行分层管理的方式构建局域网。
- 优点:易于管理和扩展,并行数据传输,性能高。
- 缺点:增加层次会降低效率。
- 举例:一个大型的企业网络可能采用树型拓扑 。计算机先连接到分支交换机上,
分 支交换机再连接到主干交换机上,实现分级管理
![1](4.jpg)
### 分布式拓扑
- 特点:任何节点都能与其他节点互联,不存在集中交换。
- 优点:无中心,任意节点故障不影响全网。
- 缺点:管理复杂,成本高。
- 举例: 比特币网络就是一个分布式拓扑的例子 。 网络中的每个节点都是对等的,
没 有中心机构 。任意两个节点都可以直接通信
![1](5.jpg)

## 通信技术
计算机网络是利用通信技术将数据从一个结点传送到另一结点的过程。
通信技术是计算机网络的基础。
信道可分为物理信道和逻辑信道。
物理信道由传输介质和设备组成， 根据传输介质的不同， 分为无线信道和有线信道。
逻辑信道是指在数据发送端和接收端之间存在的一条虚拟线路， 可以是有连接的或无连接的 。逻辑信道以物理信 道为载体。



发信机进行的信号处理包括信源编码，信道编码，交织，脉冲，调制

收信机信号处理解调，采样判决，去交织，译码

### 数据传递
如果同时传递多路数据就需要复用技术和多址技术 。

复用技术是指在一条信道上同时传输多路数据的技术， 如DM时分复用 、FDM频分复用和CDM码分复用等 。

多址技术是指在一条线上同时传输多个用户数据的技术， 在接收端把多个用户的数据分离(TDMA时分多址 、FDMA频分多址和CDMA码分多址)。

### 5G
作为新一代的移动通信技术， 5G特征体现在以下方面。
1） 实现可扩展的OFDM间隔参数配直
2） 灵活框架设计
3） 毫米波:频率大于24GHz以上的频段
4） 基于OFDM优化的波形和多址接入
5） OFDM加窗提高多路传输效率
6） 大规模MIMO:最多256根天线
7）频谱共享 8）先进的信道编码设计
5G网络的主要特征:服务化架构 、 网络切片。

## OSI七层模型
![1](6.jpg)

中继器，集线器：物理层，对接收信号进行再生，发送，只起到扩展传输距离的作用

网桥：数据链路层

路由器：网络层，IP

网关：高层协议

二层交换机：数据链路层

三层交换机：网络层

多层交换机：高层协议

### 局域网广域网协议
以太网，计算机局域网组网技术
IEEE802.3
![1](7.jpg)
### 网络协议
三要素，语法，语义，时序
#### 网络层协议
◆IP:网络层最重要的核心协议，在源地址和目的地址之间传送数据报， 无连接 、不可靠。
◆ICMP:因特网控制报文协议， 用于在IP主机 、路由器之间传递控制消息 。控制消息是指网络通不通 、主机是否可达 、路由是否可用等网络本身的消息。
◆ARP和RARP:地址解析协议，ARP是将IP地址转换为物理地址， RARP是将物理地址转换为IP地址。
◆IGMP:网络组管理协议， 允许因特网中的计算机参加多播， 是计算机用做向相邻多目路由器报告多目组成员的协议， 支持组播。

#### 传输层协议
◆TCP:整个TCP/IP协议族中最重要的协议之一，在IP协议提供的不可靠数据数据基础上，采 用了重发技术， 为应用程序提供了一个可靠的 、面向连接的 、全双工的数据传输服务 。一般 用于传输数据量比较少， 且对可靠性要求高的场合。

1、使用序号对数据报进行标记

2、TCP使用确认，校验，定时器系统提供可靠性

3、tcp使用窗口机制调整数据流量

◆UDP:是一种不可靠 、无连接的协议， 有助于提高传输速率， 一般用于传输数据量大，对可 靠性要求不高， 但要求速度快的场合。

1、无连接，使用最大努力交付，面向报文，没有拥塞控制，一对一，一对多，多对一，多对多，首部开销小

#### 应用层协议
基于TCP的FTP、HTTP等都是可靠传输 。基于UDP的DHCP、DNS等都是不可靠传输。
◆FTP:可靠的文件传输协议， 用于因特网上的控制文件的双向传输。
◆HTTP:超文本传输协议， 用于从WWW服务器传输超文本到本地浏览器的传输协议 。使用SSL 加密后的安全网页协议为HTTPS。
◆SMTP和POP3:简单邮件传输协议， 是一组用于由源地址到目的地址传送邮件的规则， 邮件报 文采用ASCII格式表示， SMTP是发送，POP3是接收
◆Telnet:远程连接协议， 是因特网远程登录服务的标准协议和主要方式。
◆TFTP:不可靠的 、开销不大的小文件传输协议。
◆SNMP:简单网络管理协议， 它主要用于网络设备与网络管理系统(NMS)之间进行监测与管理，比如路由器和交换机设备通过SNMP定期向网络管理系统上报接口流量 、CPU利用率等性能指标
◆DHCP:动态主机配置协议， 基于UDP,基于C/S模型， 为主机动态分配IP地址， 有三种方式：固定分配、动态分配、 自动分配。
◆DNS:域名解析协议， 通过域名解析出IP地址。

#### 端口对照
![1](8.jpg)
## 交换技术
交换机功能包括:
集线功能 。提供大量可供线缆连接的端口达到部署星状拓扑网络的目的。
中继功能 。在转发帧时重新产生不失真的电信号。
桥接功能 。在内置的端口上使用相同的转发和过滤逻辑。
隔离冲突域功能 。将部署好的局域网分为多个冲突域， 而每个冲突域都有自己独立的带宽， 以提高交换机整体宽带利用效率。
交换机的功能包括:
( 1)转发路径学习 。根据收到数据帧中的源MAC地址建立该地址同交换机端口的映射写入MAC地址表中。
(2)数据转发 。如果交换机根据数据帧中的目的MAC地址在建立好的MAC地址表中查询到了， 就向对应端口 进行转发。
(3)数据泛洪 。如果数据帧中的目的MAC地址不在MAC地址表中， 则向所有端口转发也就是泛洪 。广播帧和 组播帧向所有端口（不包括源端口） 进行转发。
(4)链路地址更新 。MAC地址表会每隔一定时间（如300s ） 更新一次
## 路由技术

路由功能由路由器来提供， 具体包括:
(1)异种网络互连， 比如具有异种子网协议的网络互连:
(2)子网协议转换， 不同子网间包括局域网和广域网之间的协议转换:
(3)数据路由， 即将数据从一个网络依据路由规则转发到另一个网络:
(4)速率适配， 利用缓存和流控协议进行适配:
(5)隔离网络， 防止广播风暴,实现防火墙;
(6)报文分片和重组， 超过接口的MTU报文被分片， 到达目的地之后的报文被重组:
(7)备份 、流量控制， 如主备线路的切换和复杂流量控制等。

路由器工作在OSl七层协议中的第3层， 即网络层 。其主要任务是接收来源于一个网络接口的数据包， 通常 根据此数据包的目地址决定待转发的下一个地址（即下一跳地址) 。路由器中维持着数据转发所需的路由 表， 所有数据包的发送或转发都通过查找路由表来实现 。这个路由表可以静态配置， 也可以通过动态路由 协议自动生成。

一般来说， 路由协议可分为内部网关协议（IGP） 和外部网关协议(EGP）两类。

网络建设工程可分为网络规划 、 网络设计和网络实施三个环节。

## 传输介质

### 双绞线
将多根铜线按规则缠绕在一起，能够减少干扰;分为无屏蔽双绞线UTP和屏蔽双
绞线STP，都是由一对铜线簇组成。也即我们常说的网线;双绞线的传输距离在100m以内

无屏蔽双绞线UTP:价格低，安装简单，但可靠性相对较低，分为CAT3(3类UTP，速率为10Mbps)、CAT4(4类UTP，与3类差不多，无应用）、CAT5(5类UTP，速率为100Mbps，用于快速以太网)、CAT5E(超5类UTP，速率为1000Mbps）、CAT6(6类UTP，用来替代CAT5E，速率也是
10OOMbps） 。

屏蔽双绞线STP:比之UTP增加了一层屏蔽层，可以有效的提高可靠性，但对应的价格高，安装麻烦，一般用于对传输可靠性要求很高的场合

网线有如下两种安装标准：都是八根不同颜色的网线，按照不同的顺序排序，插入水晶头中，区分在第1236四根网线的位置不同。

T568A T568B

### 光纤
由纤芯和包层组成，传输的光信号在纤芯中传输，然而从PC端出来的信号都是电信号，要经过光纤传输的话，就必须将电信号转换为光信号

多模光纤MMF:纤芯半径较大，因此可以同时传输多种不同的信号，光信号在光纤中以全反射的形式传输，采用发光二极管LED为光源，成本低，但是传输的效率和可靠性都较低，适合于短距离传输，其传输距离与传输速率相关，速率为100Mbps时为2KM，速率为1000Mbps时为550m

单模光纤SMF:纤芯半径很小，一般只能传输一种信号，采用激光二极管LD作为光源，并且只支持激光信号的传播，同样是以全反射形式传播，只不过反射角很大，看起来像一条直线，成本高，但是传输距离远，可靠性高。传输距离可达5KM

### 无线信道
无线电波，红外光波

### 通信方向
通信方向:数据通信是指发送方发送数据到接收方，这个传输过程可以分类如下:
单工:只能由设备A发给设备B，即数据流只能单向流动。
半双工:设备A和设备B可以互相通信，但是同一时刻数据流只能单向流动
全双工:设备A和设备B在任意时刻都能互相通信

异步传输:发送方每发送一个字符，需要在字符的起始和结尾处插入标识，当接收方接收到该字符时需要处理开始和结尾处的标识，处理完之后就能识别发送过来的数据，但是这样会造成资源浪费，传输效率降低。发送方和接收方并不是同时进行处理数据

同步传输:以数据块为单位进行传输，当发送方要发送数据时，先发送一个同步帧，接收方收到后做好接收准备，开始接收数据块，结束后又会有结束帧确认，这样一次传输一个数据块，效率高。

串行传输:只有一根数据线，数据只能1bit挨个排队传送，适合低速设备、远距离的传送，一般用于广域网中。
并行传输:有多根数据线，可以同时传输多个bit数据，适合高速设备的传送，常用语计算机内部各硬件模块之间。

### 交换方式
电路交换:通信一方进行呼叫，另一方接收后，在二者之间会建立一个专用电路，特点为面向连接、实时性高、链路利用率低，一般用于语音视频通信。
报文交换:以报文为单位，存储转发模式，接收到数据后先存储，进行差错校验，没有错误则转发，有错误则丢弃，因此会有延时，但可靠性高，是面向无连接的。
分组交换:以分组为单位，也是存储转发模式，因为分组的长度比报文小，所以时延小于报文交换，又可分为三种方式:
• 数据报:是现在主流的交换方式，各个分组携带地址信息，自由的选择不同的路由路径传送到接收方，接收方接收到分组后再根据地址信息重新组装成原数据，是面向无连接的，但是不可靠的。
• 虚电路:发送方发送一个分组，接收方收到后二者之间就建立了一个虚拟的通信线路，二者之间的分组数据交互都通过这条线路传送，在空闲的时候这条线路也可以传输其他数据，是面向连接的，可靠的。
• 信元交换:异步传输模式ATM采用的交换方式，本质是按照虚电路方式进行转发，只不过信元是固定长度的分组，共53B，其中5B为头部，48B为数据域，也是面向连接的，可靠的。

## IP地址

机器中存放的IP地址是32位的二进制代码，每隔8位插入一个空格，可提高可读性，为了便于理解和设置，一般会采用点分十进制方法来表示:将32位二进制代码每8位二进制转换成十进制，就变成了4个十进制数，而后在每个十进制数间隔中插入.

### 分类
分类IP地址:IP地址分四段，每段八位，共32位二进制数组成。在逻辑上，这32位IP地址分为网络号(带下划线的)和主机号，依据网络号位数的不同，可以将IP地址分为以下几类:
按照A类来分配IP地址，总计可以分配：2^24-2=16777214 
B类的分配数为：2^16-2=65534
C类的分配数为：2^8-2=254
![1](9.jpg)

无分类编址:即不按照ABC类规则，自动规定网络号，无分类编址格式为:IP地址/网络号，示
例:128.168.0.11/20表示的IP地址为128.168.0.11，其网络号占20位，因此主机号占32-20=12位，也可以划分子网。
特殊IP地址
公有地址:通过它直接访问因特网。是全网唯一的IP地址。
私有地址:属于非注册地址，专门为组织机构内部使用，不能直接访问因特网，

### 子网划分

A类地址网络号：第一部分，8位

B类地址网络号：第一部分，第二部分， 16位

C类地址网络号：第一部分，第二部分，第三部分， 24位

子网划分：一般公司在申请网络时，会直接获得一个范围很大的网络，如一个A类地址，因为主机数之间相差的太大了，不利于分配，我们一般采用子网划分的方法来划分网络，即自定义网络号位数，就能自定义主机号位数，就能根据主机个数来划分出最适合的方案，不会造成资源的浪费。

子网号：一般的IP地址按标准划分为A B C类后可以进行再一步的划分，将主机号多出的几位作为子网号，就可以划分出多个子网，

IP地址组成：网络号+子网号+主机号，网络号和子网号都为1，主机号都是0，就是子网掩码

比如只需要为30台主机分配ip地址，那么我们会申请C类的地址，C类地址是2^8次方个主机号，远远超过了30的需求，于是我们按照2^n-2=30来计算，n=5是最合适的，那么多于的那3位就是用来作为子网号，那么子网就一共可以划分2^3=8个，按照IP地址组成为：网络号+子网号+主机号来算的话，那么就是网络号24+子网号3+主机号5.网络号和子网号都为1,主机号都为0,这样的地址为子网掩码。如果把上面的例子拿来算子网掩码的话就是：24个1+3个1+5个0，得到的就是255.255.255.224要

注意的是：子网号可以为全0和全1,主机号不能为全0或全1,因此，主机数需要-2,而子网数不用。

还可以聚合网络为超网，就是划分子网的逆过程，将网络号取出几位作为主机号，此时，这个网络内的主机数量就变多了，成为一个更大的网络



三级IP地址：网络号+子网号+主机号

子网掩码：网络号全是1，主机号全是0

A类子网掩码：255.0.0.0

B类子网掩码：255.255.0.0

C类子网掩码：255.255.255.0

将ip地址与其对应的子网掩码，逐位进行与（1就是保留原先的数据。与0与就是0）运算，可以得到子网的网络地址（只包含网络号）



IP地址：131.1.123.24/27，/27代表前面27位都是网络号，前三部分是24，最后一部分的前三位也是网络号，网络号不一样代表不在同一网段，路由表的表项

/23 -》/27 主机号少4个变网络号，则是2的4次方个子网，主机号位数就是5，2的5次方，主机号不能全0或者全1，然后可确定其子网掩码

/20，可以划分多少个C类子网，C类子网的主机号是8位，网络号是24位，24-20等于4，则子网号是2的4次方

不属于子网地址算法：网络号确定，确定剩下的最大地址范围，不在范围内就不是


### IPV6

IPV6主要是为了解决IPv4地址数不够用的情况而提出的设计方案，IPv6具有以下特性：
1、 IPv6地址长度为128位，而IPV4地址仅32位，空间增大了2^96倍；
2、 灵活的IP报文头部格式，使用一系列固定格式的扩展头部取代了IPv4中可变长度的选项字段。
3、 IPv6简化了报文头部格式，加快报文转发，提高了吞吐量；
4、提高安全性，身份认证和隐私权是IPv6的关键特性；
5、支持更多的服务类型；
6、允许协议继续演变，增加新的功能，使之适应未来技术的发展。

IPV4过渡IPV6技术：

1、双协议栈技术：可同时支持

2、隧道技术：在4网络上建立一个能够传输6的数据报的隧道

3、翻译技术：4转换6

## 网络三层模型
三层模型将网络划分为核心层、汇聚层和接入层：
1、核心层：提供不同区域之间的最佳路由和高速数据传送，提高高速转发通信，骨干传输，拥有更高的可靠性，性能，吞吐量，ATM，100BASE_Fx，千兆以太网，双机冗余备份
2、 汇聚层：核心层，接入层的分界面，完成网络访问控制，数据包处理，过滤寻址，多台接入层交换机汇聚点，所以汇聚层交换机与接入层交换相比，需要更高的性能，更少的接口，更高的交换速率
3、接入层：直接面向用户连接或访问网络的部分，允许终端用户连接到网络，负责一些用户管理功能，用户信息收集工作，为用户提供了在本地网段访问应用系统的能力，还要解决相邻用户之间的互访需要，接入层要负责一些用户信息(例如用户IP地址、MAC地址和访问日志等)的收集工作和用户管理功能(包括认证和计费等)

## 网络规划与设计
建筑物综合布线系统PDS:
工作区子系统：实现工作区终端设备到水平子系统的信息插座之间的互联。
水平布线子系统：实现信息插座和管理子系统之间的连接。
管理子系统：连接各楼层水平布线子系统和垂直干缆线，负责连接控制其他子系统为连接其
他子系统提供连接手段
垂直干线子系统：实现各楼层设备间子系统之间的互连。
设备间子系统：实现中央主配线架与各种不同设备之间的连接。
建筑群子系统：各个建筑物通信系统之间的互联

![1](10.jpg)

1、工作区子系统负责房间内部各个设备终端的互联。
2、水平和垂直子系统负责不同楼层和建筑内部的互联。
3、设备间子系统实现各种设备与交换机之间的互联。
4、管理子系统实现整个综合布线系统的管理。
5、建筑群子系统实现不同建筑物之间的互联。

## 磁盘冗余阵列

RAID即磁盘冗余阵列技术，将数据分散存储在不同磁盘中，可并行读取，可冗余存储，提高磁盘访问速度，保障数据安全性。
RAID0将数据分散的存储在不同磁盘中，磁盘利用率100%,访问速度最快，但是没有提供冗余和错误修复技术；
RAID1在成对的独立磁盘上产生互为备份的数据，增加存储可靠性，可以纠错，但磁盘利用率只有50%;
![1](11.jpg)

## 网络存储技术

1.直接附加存储(DAS):是指将存储设备通过SCSI接口直接连接到一台服务器上使用，其本身是硬件的堆叠，存储操作依赖于服务器，不带有任何存储操作系统。
◆存在问题：在传递距离、连接数量、传输速率等方面都受到限制。容量难以扩展升级；数据处理和传输能力降低；服务器异常会波及存储器。

2.网络附加存储(NAS):通过网络接口与网络直接相连，由用户通过网络访问，有独立的存储系统。如下图所示。NAS存储设备类似于一个专用的文件服务器，去掉了通用服务器大多数计算功能，而仅仅提供文件系统功能。以数据为中心，将存储设备与服务器分离，其存储设
备在功能上完全独立于网络中的主服务器。客户机与存储设备之间的数据访问不再需要文件服务器的干预，同时它允许客户机与存储设备之间进行直接的数据访问，所以不仅响应速度快，而且数据传输速率也很高。
◆NAS的性能特点是进行小文件级的共享存取；支持即插即用；可以很经济的解决存储容量不足的问题，但难以获得满意的性能。

3.存储区域网(SAN):SAN是通过专用交换机将磁盘阵列与服务器连接起来的高速专用子网。它没有采用文件共享存取方式，而是采用块(block)级别存储。SAN是通过专用高速网将一个或多个网络存储设备和服务器连接起来的专用存储系统，其最大特点是将存储设备从传统的以太网中分离了出来，成为独立的存储区域网络SAN的系统结构。根据数据传输过程采用的协议，其技术划分为FCSAN(光纤通道)、IP SAN(IP网络)和IB SAN(无线带宽)技术。



## DNS

### DNS协议查询

#### 递归查询

当用户发出查询请求时，本地服务要进行递归查询，这种查询方式要求服务器彻底进行名字解析，并返回最后的结果

#### 迭代查询

服务器与服务器之间的查询采用迭代的方式进行，发出查询请求的服务器得到的响应，可能不是目标IP地址，而是其他服务器的引用，然后继续查询