---
title: 关于Mysql的视图与事务
date: 2018-04-30 15:54:03
tags: 数据库,Mysql
categories: 数据库
comments: true
description: mysql数据库的视图，事务介绍，使用
---
## 视图

### 简介
视图是一个虚拟表，其内容由查询定义。同真实的表一样，视图包含一系列带有名称的列和行数据。但是，视图并不在数据库中以存储的数据值集形式存在。行和列数据来自由定义视图的查询所引用的表，并且在引用视图时动态生成。
对其中所引用的基础表来说，视图的作用类似于筛选。定义视图的筛选可以来自当前或其它数据库的一个或多个表，或者其它视图。通过视图进行查询没有任何限制，通过它们进行数据修改时的限制也很少。
视图是存储在数据库中的查询的SQL 语句，它主要出于两种原因：安全原因， 视图可以隐藏一些数据，如：社会保险基金表，可以用视图只显示姓名，地址，而不显示社会保险号和工资数等，另一原因是可使复杂的查询易于理解和使用。这个视图就像一个“窗口”，从中只能看到你想看的数据列。这意味着你可以在这个视图上使用SELECT 语句，而你看到的将是你在视图定义里给出的那些数据列。

### 特点
1.视图能简化用户操作
视图机制使用户可以将注意力集中在所关心地数据上。如果这些数据不是直接来自基本表，则可以通过定义视图，使数据库看起来结构简单、清晰，并且可以简化用户的的数据查询操作。
2.使用户能以多种角度看待同一数据
视图机制能使不同的用户以不同的方式看待同一数据，当许多不同种类的用户共享同一个数据库时，这种灵活性是非常必要的。
3.视图对重构数据库提供了一定程度的逻辑独立性
数据的物理独立性是指用户的应用程序不依赖于数据库的物理结构。数据的逻辑独立性是指当数据库重构造时，如增加新的关系或对原有的关系增加新的字段，用户的应用程序不会受影响。层次数据库和网状数据库一般能较好地支持数据的物理独立性，而对于逻辑独立性则不能完全的支持。
在关许数据库中，数据库的重构造往往是不可避免的。重构数据库最常见的是将一个基本表“垂直”地分成多个基本表。如果使用视图，应用程序不必修改，因为新建立的视图定义为用户原来的关系，使用户的外模式保持不变，用户的应用程序通过视图仍然能够查找数据。
当然，视图只能在一定程度上提供数据的逻辑独立，比如由于视图的更新是有条件的，因此应用程序中修改数据的语句可能仍会因为基本表构造的改变而改变。
4.视图能够对机密数据提供安全保护
有了视图机制，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，使机密数据不出现在不应该看到这些数据的用户视图上。这样视图机制就自动提供了对机密数据的安全保护功能。

### 创建视图

``` javascript
create view v-表名 as 查询语句
```

### 删除视图

``` javascript
drop view v-表名；
```
## 事务

### 什么是事务
所谓事务,它是一个操作序列，这些操作要么都执行，要么都不执行，它是一个不可分割的工作单位。

### 四大特性（ACID）

#### 原子性（A）
一个事务必须被视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性

#### 一致性（C）
数据库总是从一个一致性的状态转换到另一个一致性的状态。事务不提交是不会修改数据的。

#### 隔离性（I）
通常来说，一个事务所做的修改在最终提交以前，对其他事务是不可见的。
#### 持久性（D）
一旦事务提交，则其所做的修改会永久保存到数据库。

### 事务命令
表的引擎类型必须是innodb类型才可以使用事务，这是mysql表的默认引擎。

#### 开启事务

``` javascript
begin;
或者
start transaction;
```

#### 提交事务

``` javascript
commit;
```

#### 回滚事务

``` javascript
rollback;
```
注意：
修改数据的命令会自动的触发事务，包括insert、update、delete
而在SQL语句中有手动开启事务的原因是：可以进行多次数据的修改，如果成功一起成功，否则一起会滚到之前的数据。
